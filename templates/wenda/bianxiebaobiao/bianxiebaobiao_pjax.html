<title>编辑编写报表</title>
<script src="/statics/custom/js/echarts.min.js"></script>

<style>

    .btn.focus, .btn:focus, .btn:hover {
        color: white;
    }

    .search_form>div{
        margin-bottom: 10px;
    }

    .search_form label{

        width: 85px;
        text-align: right;
    }

    .search_form input, .search_form select{
        display: inline-block;
        width: 300px
    }
    .search_form select{
        display: inline-block;
        width: 100px
    }

    #create_date{
        width: 120px;
    }
    tbody{
        text-align: center;
    }

</style>

{% csrf_token %}
<div class="page animation-fade page-index page-data-tables">
    <div class="page-content">

        <div class="panel" style="padding: 10px; height: auto">
            <form class="form-horizontal search_form">
                <div>
                    <label for="department_id">科室：</label>
                    <select class="form-control select2-hidden-accessible" data-plugin="select2" tabindex="-1" aria-hidden="true" id="department_id" name="department_id">
                        <option value="">全部</option>
                        {% for obj in department_objs %}
                            <option value="{{ obj.id }}">{{ obj.name }}</option>
                        {% endfor %}
                    </select>

                    <label for="keywords__client_user_id">用户名称：</label>
                    <select class="form-control select2-hidden-accessible" data-plugin="select2" tabindex="-1" aria-hidden="true" id="keywords__client_user_id" name="keywords__client_user_id">
                        <option value="">全部</option>
                        {% for obj in user_objs %}
                            <option value="{{ obj.id }}">{{ obj.username }}</option>
                        {% endfor %}
                    </select>

                    <label for="create_date">查询日期：</label>
                    <input class="Wdate form-control" id="create_date" name="create_date" value="{{ now_date }}" onclick="WdatePicker({dateFmt:'yyyy-MM-dd'})" type="text">

                    <label for="page_type">覆盖类型：</label>
                    <select class="form-control" name="page_type" id="page_type">
                        <option value="">全部</option>
                        {% for i in page_type_choices %}
                            <option value="{{ i.0 }}">{{ i.1 }}</option>
                        {% endfor %}
                    </select>
                </div>

{#                <div>#}
{#                    <label for="search_keyword">关键词搜索：</label>#}
{#                    <input class="form-control" name="search_keyword" id="search_keyword" type="text" placeholder="关键词模糊搜索模糊搜索">#}
{##}
{#                    <label for="task_type">知道类型：</label>#}
{#                    <select class="form-control" name="task_type" id="task_type">#}
{#                        <option value="">全部</option>#}
{#                        {% for i in task_type_choices %}#}
{#                            <option value="{{ i.0 }}">{{ i.1 }}</option>#}
{#                        {% endfor %}#}
{#                    </select>#}
{#                </div>#}

                <div style="position: absolute; bottom:0; right: 20px;">
                    <button type="button" class="btn btn-primary" id="search_button"><i class="icon fa-search" aria-hidden="true"></i>搜索</button>
                </div>

            </form>
        </div>

        <div class="panel" style="height: 100%;">
            <div class="panel-body">

                <div id="echarts_main" style="width: 80%;height:400px;"></div>

            </div>
        </div>
    </div>
</div>


<script>

    $(function () {
        var get_url = "?type=ajax_json";
        $.get(get_url, function (data) {
            // 基于准备好的dom，初始化echarts实例
            var myChart = echarts.init(document.getElementById('echarts_main'));

            // 指定图表的配置项和数据
            option = data.option;


            // 使用刚指定的配置项和数据显示图表。
            myChart.setOption(option);

        }, 'json');


    })



    {# 搜索按钮被点击 #}
    $("#search_button").click(function () {
        var search_data = $(".search_form").serialize();
        var get_url = "?type=ajax_json&" + search_data;

        table.ajax.url(get_url);
        table.draw();

    });

    {# 搜框中的input标签 回车键被触发 #}
    $(".search_form input").keydown(function () {
        var e=window.event||arguments.callee.caller.arguments[0];
        if(e.keyCode==13){
            $("#search_button").click();
        }
    });

    {# 搜框中的select标签 回车键被触发 #}
    $(".search_form select").change(function () {
        $("#search_button").click();
    });

</script>
